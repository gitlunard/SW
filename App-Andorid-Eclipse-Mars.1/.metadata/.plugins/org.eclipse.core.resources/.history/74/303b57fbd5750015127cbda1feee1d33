package it.test.serviceschedule;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.PrintWriter;
import java.net.Socket;
import java.net.UnknownHostException;
import android.support.v7.app.ActionBarActivity;
import android.os.AsyncTask;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuItem;
import android.widget.TextView;

/**
 * 
 * @author leo
 *
 */
class ClientAsyncTask extends AsyncTask<String, Void, String> {
	  @Override
	  protected String doInBackground(String... params) {
	   String result = null;
	   try {
	    //Create a client socket and define internet address and the port of the server
	    Socket socket = new Socket(params[0],
	      Integer.parseInt(params[1]));
	    //Get the input stream of the client socket
	    InputStream is = socket.getInputStream();
	    //Get the output stream of the client socket
	    PrintWriter out = new PrintWriter(socket.getOutputStream(),true);
	    //Write data to the output stream of the client socket
	    out.println(params[2]); 
	    //Buffer the data coming from the input stream
	    BufferedReader br = new BufferedReader(
	      new InputStreamReader(is));
	    //Read data in the input buffer
	    result = br.readLine();
	    //Close the client socket
	    socket.close();
	   } catch (NumberFormatException e) {
	    e.printStackTrace();
	   } catch (UnknownHostException e) {
	    e.printStackTrace();
	   } catch (IOException e) {
	    e.printStackTrace();
	   }
	   return result;
	  }
	  @Override
	  protected void onPostExecute(String s) {
	   //Write server message to the text view
	   tvServerMessage.setText(s);
	  }
	 }

